# JNCTF-2019：我的祖国

## **【原理】**

1. png 图片在二进制文件中修改图片的高度或者宽度会导致部分信息被隐藏，无法显示。
2. 把字符串加密成 **摩斯密码** 之后，经信息藏到 gif 的帧动画内，通过提取获得。
3. 以 . 开头的文件以及文件夹会被隐藏，需要仔细查看才能看到。（或者打开显示隐藏文件），之后使用 JSFuck 解码。

## **【目的】**

考察对图片隐写的几种方法的了解以及对二进制文件的处理。还有常规加密方法的了解。

## **【环境】**

Win10  or Mac or LInux

## **【工具】**

- 010 Editor
- Chrome
- GIF 分解

## **【步骤】**

根据题目提示，flag 是被分割成了三个部分，所以。。。

先看图片吧，打开之后很正常。。1949.png 图片中是开国大典的油画。

![1567841357515](assets\1567841357515.png)

注意看左下角，有什么东西没有显示出来，所以可以猜测这个图片是修改了高度的图片，所以使用二进制编辑工具打开图片，修改图片的高度

![1567840423853](assets\1567840423853.png)

之后打开图片就可以看到一个二维码

![1567841396328](assets\1567841396328.png)



扫码得到 `JNCTF{celebrate-` 明显这只是 flag 的第一部分，也验证了题目中的说法。接着，我们看一下这个图片的大小 15.8 M，这个应该不是一个普通的图片吧，所以试着把图片用压缩包工具解压试试。

成功解压出来一个文件夹

![1567837994581](assets\1567837994581.png)

里面有两个文件，一个是 .1970的隐藏文件夹，一个是 1956.gif。。。现在联想一下题目中的说法，历史的长河中，也就是说 1949那个图片是第一部分，1956.gif 是第二部分，1970 是第三部分。

1956.gif 在播放的时候，只有三个图片，提取每一帧。。

![1567839133199](assets\1567839133199.png)

分析出来的，一个是章鱼哥举笛子，一个是放下笛子，一个是不吹了去骂海绵宝宝了。。对应着的应该是 `-` `.` ` `，也就是莫斯密码。。按照循序转换的结果是 `- .. .- -. .- -. -- . -. ` 解码得：`tiananmen` 这就是第二段了。

接下来是第三段，.1970，打开后是

```raw
(+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])
```

JSFUCK　编码，所以就直接在浏览器执行：

![1567839379096](assets\1567839379096.png)

得到最后一段`-satellite}`



## **【总结】**

所以 flag 就是 

`JNCTF{celebrate-tiananmen-satellite}`